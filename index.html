<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.15.1/dist/phaser-arcade-physics.min.js"></script>
</head>
<body>

<script>
    var config = {
        type: Phaser.AUTO,
        width: 640,
        height: 480,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: {y: 1000}
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    var game = new Phaser.Game(config);

    var player
    function preload() {
        this.load.image('sky', 'assets/background.png');
        this.load.image('ground', 'assets/ground.png');
        this.load.image('dude', 'assets/ZUMBINO.png');
        
        // this.load.image('logo', 'assets/sprites/phaser3-logo.png');
        // this.load.image('red', 'assets/particles/red.png');
    }

    function create() {
        this.add.image(320, 240, 'sky');

        let platforms = this.physics.add.staticGroup();

        for (let i = 0; i < 10; i++) {
            platforms.create(270*0.3 * i, 450, 'ground').setScale(0.3).refreshBody()
        }

        // var particles = this.add.particles('red');

        // var emitter = particles.createEmitter({
        //     speed: 100,
        //     scale: {start: 1, end: 0},
        //     blendMode: 'ADD'
        // });

        // var logo = this.physics.add.image(400, 100, 'logo');

        // logo.setVelocity(100, 200);
        // logo.setBounce(1, 1);
        // logo.setCollideWorldBounds(true);

        // emitter.startFollow(logo);

        player = this.physics.add.sprite(20, 300, 'dude').setScale(0.1);
        this.physics.add.collider(platforms, player);
        player.setBounce(0.2);
        player.setCollideWorldBounds(true);
        

        this.anims.create({
            key: 'left',
            frames: this.anims.generateFrameNumbers('dude', { start: 0, end: 0 }),
            frameRate: 10,
            repeat: -1
        });

        this.anims.create({
            key: 'turn',
            frames: [ { key: 'dude', frame: 0} ],
            frameRate: 100
        });

        this.anims.create({
            key: 'right',
            frames: this.anims.generateFrameNumbers('dude', { start:0 , end: 0 }),
            frameRate: 100,
            repeat: -1
        });
    }

    function update() {
        let cursors = this.input.keyboard.createCursorKeys();

        if (cursors.left.isDown) {
            player.setVelocityX(-160);
            player.anims.play('left', true);
        } else if (cursors.right.isDown) {
            player.setVelocityX(160);

            player.anims.play('right', true);
        } else {
            player.setVelocityX(0);
            player.anims.play('turn');
        }

        if (cursors.up.isDown && player.body.touching.down) {
            player.setVelocityY(-330);
        }
    }
</script>

</body>
</html>
